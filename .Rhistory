pivot_wider(names_from = ComparisonFactor, values_from = Value) %>%
group_by(Id, Label, Axis, EventContext, Cycle)
descKinematicTableTD %>%
select(ComparisonFactor, Id, Label, Axis, EventContext, Cycle, Frame0:Frame100) %>%
pivot_longer(cols = Frame0:Frame100, values_to = "Value", names_to = "Variable") %>%
pivot_wider(names_from = ComparisonFactor, values_from = Value) %>%
group_by(Id, Label, Axis, EventContext, Cycle) %>%
mutate(Metrics = do.call(get("mae"), list(.data[["CGM21_NonOpt"]], .data[["CGM22_6Dof"]])),
Comparisonlabel = comparisonLabel)
descKinematicTableTD %>%
select(ComparisonFactor, Id, Label, Axis, EventContext, Cycle, Frame0:Frame100) %>%
pivot_longer(cols = Frame0:Frame100, values_to = "Value", names_to = "Variable") %>%
pivot_wider(names_from = ComparisonFactor, values_from = Value) %>%
group_by(Id, Label, Axis, EventContext, Cycle) %>%
mutate(Metrics = do.call(get("mae"), list(.data[["CGM21_NonOpt"]], .data[["CGM22_6Dof"]])),
Comparisonlabel = comparisonLabel)
descKinematicTableTD %>%
select(ComparisonFactor, Id, Label, Axis, EventContext, Cycle, Frame0:Frame100) %>%
pivot_longer(cols = Frame0:Frame100, values_to = "Value", names_to = "Variable") %>%
pivot_wider(names_from = ComparisonFactor, values_from = Value) %>%
group_by(Id, Label, Axis, EventContext, Cycle) %>%
mutate(Metrics = Metrics::mae(.data[["CGM21_NonOpt"]],.data[["CGM22_6Dof"]]),
Comparisonlabel=comparisonLabel)
IL_nonopt_6dof = computeMAE(kinematicTableOMD, "CGM21_NonOpt","CGM22_6Dof",comparisonLabel = "nonOpt_vs_6dof")
IL_nonopt_6dof = computeMetrics(kinematicTableOMD, "CGM21_NonOpt","CGM22_6Dof",comparisonLabel = "nonOpt_vs_6dof",metric="mae")
kinematicTableOMD%>%
filter(ComparisonFactor=="CGM21_NonOpt" & Label="AnkleAngles" & Axis="X")
kinematicTableOMD$ComparisonFactor
kinematicTableOMD %>%
filter(ComparisonFactor=="CGM21_NonOpt" & Label="AnkleAngles" & Axis="X")
kinematicTableOMD %>%
filter(ComparisonFactor=="CGM21_NonOpt" & Label=="AnkleAngles" & Axis=="X")
kinematicTableOMD %>%
filter(ComparisonFactor=="CGM21_NonOpt" & Label=="AnkleAngles" & Axis=="X")%>%
select(-Frame001:Frame099)
kinematicTableOMD %>%
filter(ComparisonFactor=="CGM21_NonOpt" & Label=="AnkleAngles" & Axis=="X")%>%
select(Frame100)
kinematicTableOMD %>%
filter(ComparisonFactor=="CGM21_NonOpt" & Label=="AnkleAngles" & Axis=="X")%>%
select(Frame100:)
kinematicTableOMD %>%
filter(ComparisonFactor=="CGM21_NonOpt" & Label=="AnkleAngles" & Axis=="X")
kinematicTableOMD %>%
filter(ComparisonFactor=="CGM21_NonOpt" & Label=="AnkleAngles" & Axis=="X")%>%
select(Frame100:Population)
kinematicTableOMD %>%
filter(ComparisonFactor=="CGM21_NonOpt" & Label=="AnkleAngles" & Axis=="X")%>%
select(Label,EventContext,Cycle,Id)
kinematicTableOMD =  tableOMD2 %>%
mutate(
EventContext = case_when(
Affected_side == "Both" ~ "Involved",
EventContext == Affected_side ~ "Involved",
TRUE ~ "Unvolved"  ))%>%
rename (Id = Ipp)%>%
defineComparisonfactor(c("CGM","Pose"))%>%
filter(Label %ni% c("LForeFootAngles","RForeFootAngles"))%>%
mutate(Label = substring(Label,2),
Population = "OMD")%>%
group_by(Id,ComparisonFactor,Label,Axis,EventContext)%>%
mutate(Cycle2 = 1:n())
descKinematicTableOMD <- DescritiveFrameSequence(kinematicTableOMD,bySubjectFlag = FALSE)
kinematicTableOMD %>%
filter(ComparisonFactor=="CGM21_NonOpt" & Label=="AnkleAngles" & Axis=="X")%>%
select(Label,EventContext,Cycle,Id)
kinematicTableOMD %>%
filter(ComparisonFactor=="CGM21_NonOpt" & Label=="AnkleAngles" & Axis=="X")%>%
select(Label,EventContext,Cycle,Id,Cycle2)
kinematicTableOMD =  tableOMD2 %>%
mutate(
EventContext = case_when(
Affected_side == "Both" ~ "Involved",
EventContext == Affected_side ~ "Involved",
TRUE ~ "Unvolved"  ))%>%
rename (Id = Ipp)%>%
defineComparisonfactor(c("CGM","Pose"))%>%
filter(Label %ni% c("LForeFootAngles","RForeFootAngles"))%>%
mutate(Label = substring(Label,2),
Population = "OMD")%>%
group_by(Id,ComparisonFactor,Label,Axis,EventContext)%>%
mutate(Cycle = 1:n())
descKinematicTableOMD <- DescritiveFrameSequence(kinematicTableOMD,bySubjectFlag = FALSE)
kinematicTableOMD$ComparisonFactor
kinematicTableOMD %>%
filter(ComparisonFactor=="CGM21_NonOpt" & Label=="AnkleAngles" & Axis=="X")%>%
select(Label,EventContext,Cycle,Id)
IL_nonopt_6dof = computeMetrics(kinematicTableOMD, "CGM21_NonOpt","CGM22_6Dof",comparisonLabel = "nonOpt_vs_6dof",metric="mae")
desc = IL_nonopt_6dof%>%
filter(Label %in% c("PelvisAngles","HipAngles","KneeAngles", "AnkleAngles","FootProgressAngles"))%>%
filter(EventContext=="Involved")%>%
group_by(Id,Label,Axis,Comparisonlabel)%>%
summarise(avg =  mean(Metrics),
std = sd(Metrics))%>%
filter(!(Axis %in% c("X", "Y") & Label == "FootProgressAngles"))
ggplot(desc, aes(x=Label, y= avg, color = Axis))+geom_boxplot()
TD_nonopt_kf8 = computeMetrics(kinematicTableTD, "CGM21_NonOpt","CGM22_GO_e8",comparisonLabel = "nonOpt_vs_KF8",metric="mae")
TD_nonopt_kkf = computeMetrics(kinematicTableTD, "CGM21_NonOpt","CGM22_GO_kalman",comparisonLabel = "nonOpt_vs_KKF",metric="mae")
data = bind_rows(TD_nonopt_kf8,TD_nonopt_kkf)
desc = data%>%
filter(Label %in% c("PelvisAngles","HipAngles","KneeAngles", "AnkleAngles","FootProgressAngles"))%>%
group_by(Id,Label,Axis,Comparisonlabel)%>%
summarise(avg =  mean(Metrics),
std = sd(Metrics))%>%
filter(!(Axis %in% c("X", "Y") & Label == "FootProgressAngles"))
ggplot(desc, aes(x=Label, y= avg, color = Axis))+geom_boxplot()
IL_nonopt_kf8 = computeMetrics(kinematicTableOMD, "CGM21_NonOpt","CGM22_GO_e8",comparisonLabel = "nonOpt_vs_KF8",metric="mae")
IL_nonopt_kkf = computeMetrics(kinematicTableOMD, "CGM21_NonOpt","CGM22_GO_kalman",comparisonLabel = "nonOpt_vs_KKF",metric="mae")
data = bind_rows(IL_nonopt_kf8,IL_nonopt_kkf)
desc = data%>%
filter(Label %in% c("PelvisAngles","HipAngles","KneeAngles", "AnkleAngles","FootProgressAngles"))%>%
group_by(Id,Label,Axis,Comparisonlabel)%>%
summarise(avg =  mean(Metrics),
std = sd(Metrics))%>%
filter(!(Axis %in% c("X", "Y") & Label == "FootProgressAngles"))
desc
ggplot(desc, aes(x=Label, y= avg, color = Axis))+geom_boxplot()
TD_nonopt_kf8 = computeMetrics(kinematicTableTD, "CGM21_NonOpt","CGM23_GO_e8",comparisonLabel = "nonOpt_vs_KF8",metric="mae")
TD_nonopt_kkf = computeMetrics(kinematicTableTD, "CGM21_NonOpt","CGM23_GO_kalman",comparisonLabel = "nonOpt_vs_KKF",metric="mae")
data = bind_rows(TD_nonopt_kf8,TD_nonopt_kkf)
desc = data%>%
filter(Label %in% c("PelvisAngles","HipAngles","KneeAngles", "AnkleAngles","FootProgressAngles"))%>%
group_by(Id,Label,Axis,Comparisonlabel)%>%
summarise(avg =  mean(Metrics),
std = sd(Metrics))%>%
filter(!(Axis %in% c("X", "Y") & Label == "FootProgressAngles"))
desc
ggplot(desc, aes(x=Label, y= avg, color = Axis))+geom_boxplot()
IL_nonopt_kf8 = computeMetrics(kinematicTableOMD, "CGM21_NonOpt","CGM23_GO_e8",comparisonLabel = "nonOpt_vs_KF8",metric="mae")
IL_nonopt_kkf = computeMetrics(kinematicTableOMD, "CGM21_NonOpt","CGM23_GO_kalman",comparisonLabel = "nonOpt_vs_KKF",metric="mae")
data = bind_rows(IL_nonopt_kf8,IL_nonopt_kkf)
desc = data%>%
filter(Label %in% c("PelvisAngles","HipAngles","KneeAngles", "AnkleAngles","FootProgressAngles"))%>%
group_by(Id,Label,Axis,Comparisonlabel)%>%
summarise(avg =  mean(Metrics),
std = sd(Metrics))%>%
filter(!(Axis %in% c("X", "Y") & Label == "FootProgressAngles"))
desc
ggplot(desc, aes(x=Label, y= avg, color = Axis))+geom_boxplot()
data1 = computeMetrics(kinematicTableTD, "CGM22_GO_e8","CGM23_GO_e8",comparisonLabel = "22KF8_vs_23KF8",metric="mae")
data2 = computeMetrics(kinematicTableTD, "CGM22_GO_kalman","CGM23_GO_kalman",comparisonLabel = "22KKF_vs_23KKF",metric="mae")
data = bind_rows(data1,data2)
desc = data%>%
filter(Label %in% c("PelvisAngles","HipAngles","KneeAngles", "AnkleAngles","FootProgressAngles"))%>%
group_by(Id,Label,Axis,Comparisonlabel)%>%
summarise(avg =  mean(Metrics),
std = sd(Metrics))%>%
filter(!(Axis %in% c("X", "Y") & Label == "FootProgressAngles"))
desc
ggplot(desc, aes(x=Label, y= avg, color = Axis))+geom_boxplot()
kinematicTableTD%>%ungroup()%>% select(ComparisonFactor)%>%distinct()
TD_nonopt_6dof = computeMAE(kinematicTableTD, "CGM21_NonOpt","CGM22_6Dof",comparisonLabel = "nonOpt_vs_6dof")
data1 = computeMetrics(kinematicTableOMD, "CGM22_GO_e8","CGM23_GO_e8",comparisonLabel = "22KF8_vs_23KF8",metric="mae")
data2 = computeMetrics(kinematicTableOMD, "CGM22_GO_kalman","CGM23_GO_kalman",comparisonLabel = "22KKF_vs_23KKF",metric="mae")
data = bind_rows(data1,data2)
desc = data%>%
filter(Label %in% c("PelvisAngles","HipAngles","KneeAngles", "AnkleAngles","FootProgressAngles"))%>%
group_by(Id,Label,Axis,Comparisonlabel)%>%
summarise(avg =  mean(Metrics),
std = sd(Metrics))%>%
filter(!(Axis %in% c("X", "Y") & Label == "FootProgressAngles"))
desc
ggplot(desc, aes(x=Label, y= avg, color = Axis))+geom_boxplot()
data1 = computeMetrics(kinematicTableTD, "CGM22_GO_e8","CGM22_GO_kalman",comparisonLabel = "22KF8_vs_22KKF",metric="mae")
data2 = computeMetrics(kinematicTableTD, "CGM23_GO_e8","CGM23_GO_kalman",comparisonLabel = "23KF8_vs_23KKF",metric="mae")
data = bind_rows(data1,data2)
desc = data%>%
filter(Label %in% c("PelvisAngles","HipAngles","KneeAngles", "AnkleAngles","FootProgressAngles"))%>%
group_by(Id,Label,Axis,Comparisonlabel)%>%
summarise(avg =  mean(Metrics),
std = sd(Metrics))%>%
filter(!(Axis %in% c("X", "Y") & Label == "FootProgressAngles"))
desc
ggplot(desc, aes(x=Label, y= avg, color = Axis))+geom_boxplot()
data1 = computeMetrics(kinematicTableTD, "CGM22_GO_e8","CGM22_GO_kalman",comparisonLabel = "22KF8_vs_22KKF",metric="mae")
data2 = computeMetrics(kinematicTableTD, "CGM23_GO_e8","CGM23_GO_kalman",comparisonLabel = "23KF8_vs_23KKF",metric="mae")
data = bind_rows(data1,data2)
desc = data%>%
filter(Label %in% c("PelvisAngles","HipAngles","KneeAngles", "AnkleAngles","FootProgressAngles"))%>%
group_by(Id,Label,Axis,Comparisonlabel)%>%
summarise(avg =  mean(Metrics),
std = sd(Metrics))%>%
filter(!(Axis %in% c("X", "Y") & Label == "FootProgressAngles"))
desc
ggplot(desc, aes(x=Label, y= avg, color = Axis))+geom_boxplot()
data1 = computeMetrics(kinematicTableOMD, "CGM22_GO_e8","CGM22_GO_kalman",comparisonLabel = "22KF8_vs_22KKF",metric="mae")
data2 = computeMetrics(kinematicTableOMD, "CGM23_GO_e8","CGM23_GO_kalman",comparisonLabel = "23KF8_vs_23KKF",metric="mae")
data = bind_rows(data1,data2)
desc = data%>%
filter(Label %in% c("PelvisAngles","HipAngles","KneeAngles", "AnkleAngles","FootProgressAngles"))%>%
group_by(Id,Label,Axis,Comparisonlabel)%>%
summarise(avg =  mean(Metrics),
std = sd(Metrics))%>%
filter(!(Axis %in% c("X", "Y") & Label == "FootProgressAngles"))
desc
ggplot(desc, aes(x=Label, y= avg, color = Axis))+geom_boxplot()
ggplot(desc, aes(x=Label, y= avg, color = Axis))+geom_boxplot()+facet_grid(.~Comparisonlabel)
ggplot(desc, aes(x=Label, y= avg, color = Axis))+geom_boxplot()+facet_grid(Comparisonlabel.~)
ggplot(desc, aes(x=Label, y= avg, color = Axis))+geom_boxplot()+facet_grid(Comparisonlabel.~)
ggplot(desc, aes(x=Label, y= avg, color = Axis))+geom_boxplot()+facet_grid(Comparisonlabel~.)
TD_nonopt_6dof = computeMetrics(kinematicTableTD, "CGM21_NonOpt","CGM22_6Dof",comparisonLabel = "nonOpt_vs_6dof",metric="mae")
desc_H1 = TD_nonopt_6dof%>%
filter(Label %in% c("PelvisAngles","HipAngles","KneeAngles", "AnkleAngles","FootProgressAngles"))%>%
group_by(Id,Label,Axis,Comparisonlabel)%>%
summarise(avg =  mean(Metrics),
std = sd(Metrics))%>%
filter(!(Axis %in% c("X", "Y") & Label == "FootProgressAngles"))
ggplot(desc_H1, aes(x=Label, y= avg, color = Axis))+geom_boxplot()
desc_H1_TD = TD_nonopt_6dof%>%
filter(Label %in% c("PelvisAngles","HipAngles","KneeAngles", "AnkleAngles","FootProgressAngles"))%>%
group_by(Id,Label,Axis,Comparisonlabel)%>%
summarise(avg =  mean(Metrics),
std = sd(Metrics))%>%
filter(!(Axis %in% c("X", "Y") & Label == "FootProgressAngles"))
IL_nonopt_6dof = computeMetrics(kinematicTableOMD, "CGM21_NonOpt","CGM22_6Dof",comparisonLabel = "nonOpt_vs_6dof",metric="mae")
desc_H1_IL = IL_nonopt_6dof%>%
filter(Label %in% c("PelvisAngles","HipAngles","KneeAngles", "AnkleAngles","FootProgressAngles"))%>%
filter(EventContext=="Involved")%>%
group_by(Id,Label,Axis,Comparisonlabel)%>%
summarise(avg =  mean(Metrics),
std = sd(Metrics))%>%
filter(!(Axis %in% c("X", "Y") & Label == "FootProgressAngles"))
ggplot(desc_H1_IL, aes(x=Label, y= avg, color = Axis))+geom_boxplot()
data1 = computeMetrics(kinematicTableTD, "CGM22_GO_e8","CGM23_GO_e8",comparisonLabel = "22KF8_vs_23KF8",metric="mae")
data2 = computeMetrics(kinematicTableTD, "CGM22_GO_kalman","CGM23_GO_kalman",comparisonLabel = "22KKF_vs_23KKF",metric="mae")
data_H4_TD = bind_rows(data1,data2)
desc_H4_TD = data_H4_TD%>%
filter(Label %in% c("PelvisAngles","HipAngles","KneeAngles", "AnkleAngles","FootProgressAngles"))%>%
group_by(Id,Label,Axis,Comparisonlabel)%>%
summarise(avg =  mean(Metrics),
std = sd(Metrics))%>%
filter(!(Axis %in% c("X", "Y") & Label == "FootProgressAngles"))
desc_H4_TD
ggplot(desc_H4_TD, aes(x=Label, y= avg, color = Axis))+geom_boxplot()+facet_grid(Comparisonlabel~.)
data_H4_TD%>%filter(Metrics)
ggplot(desc_H4_TD, aes(x=Label, y= avg, color = Axis))+geom_boxplot()+facet_grid(Comparisonlabel~.)
data_H4_TD%>%filter(Metrics >20)
data_H4_TD%>%
filter(Metrics >20)%>%
select(Id)%>%
dictinct()
data_H4_TD%>%
filter(Metrics >20)%>%
select(Id)%>%
distinct()
data_H4_TD%>%
ungroup()%>%
filter(Metrics >20)%>%
select(Id)%>%
distinct()
ggplot(desc_H4_TD, aes(x=Label, y= avg, color = Axis))+geom_boxplot()+facet_grid(Comparisonlabel~.)
data_H4_TD%>%
ungroup()%>%
filter(Metrics >20)%>%
select(Id)%>%
distinct()
datatoPlot = filter(descKinematicTableTD,
Label == "HipAngles" & Axis == "Z" & EventContext =="Overall" & Id=="03563")
datatoPlot
datatoPlot = filter(kinematicTableTD,
Label == "HipAngles" & Axis == "Z" & EventContext =="Overall" & Id=="03563")
datatoPlot = filter(kinematicTableTD,
Label == "HipAngles" & Axis == "Z" & EventContext =="Overall" & Id=="03563")
datatoPlot
ggplotLayer(legendPosition = "none",
iTitle="Hip Rotation") +
geom_descriptiveLine(datatoPlot)
ggplotLayer(legendPosition = "none",
iTitle="Hip Rotation") +
geom_consistencyLine(datatoPlot)
data_H4_IL%>%
ungroup()%>%
filter(Metrics >20)%>%
select(Id)%>%
distinct()
data1 = computeMetrics(kinematicTableOMD, "CGM22_GO_e8","CGM23_GO_e8",comparisonLabel = "22KF8_vs_23KF8",metric="mae")
data2 = computeMetrics(kinematicTableOMD, "CGM22_GO_kalman","CGM23_GO_kalman",comparisonLabel = "22KKF_vs_23KKF",metric="mae")
data_H4_IL = bind_rows(data1,data2)
datatoPlot = filter(kinematicTableTD,
Label == "HipAngles" & Axis == "Z" & EventContext =="Overall" & Id=="03563" &
ComparisonFactor %in% c("CGM22_GO_e8","CGM23_GO_e8","CGM22_GO_kalman","CGM23_GO_kalman") )
ggplotLayer(legendPosition = "none",
iTitle="Hip Rotation") +
geom_consistencyLine(datatoPlot)
data_H4_TD%>%
ungroup()%>%
filter(Metrics >20)%>%
select(Id)%>%
distinct()
names(data_H4_TD)
data_H4_TD%>%
ungroup()%>%
filter(Metrics >20)%>%
select(Id,Cycle)%>%
distinct()
data_H4_TD%>%
ungroup()%>%
filter(Metrics >20)%>%
select(Id,Cycle,Metrics)%>%
data_H4_TD%>%
ungroup()%>%
filter(Metrics >20)%>%
select(Id,Cycle,Metrics)
data_H4_TD%>%
ungroup()%>%
filter(Metrics >20)%>%
select(Id,Cycle,Metrics)
data_H4_TD%>%
ungroup()%>%
filter(Metrics >20)%>%
select(Id,Label,Axis,Cycle,Metrics)
data_H4_TD%>%
ungroup()%>%
filter(Metrics >20)%>%
select(Id,Label,Axis,Cycle,Metrics,comparisonLabel)
data_H4_TD%>%
ungroup()%>%
filter(Metrics >20)%>%
select(Id,Label,Axis,Cycle,Metrics,comparisonLabel)
names(data_H4_TD)
data_H4_TD%>%
ungroup()%>%
filter(Metrics >20)%>%
select(Id,Label,Axis,Cycle,Metrics,Comparisonlabel)
datatoPlot = filter(kinematicTableTD,
Label == "HipAngles" & Axis == "Z" & EventContext =="Overall" & Id=="03563" & Cycle==1 &
ComparisonFactor %in% c("CGM22_GO_e8","CGM23_GO_e8") )
ggplotLayer(legendPosition = "none",
iTitle="Hip Rotation") +
geom_consistencyLine(datatoPlot)
data_H4_IL%>%
ungroup()%>%
filter(Metrics >20)%>%
select(Id)%>%
distinct()
data_H4_IL%>%
ungroup()%>%
filter(Metrics >20)%>%
select(Id,Label,Axis,Cycle,Metrics,Comparisonlabel)
datatoPlot = filter(kinematicTableOMD,
Label == "KneeAngles" & Axis == "Z" & EventContext =="Involved" & Id=="03711" & Cycle==1 &
ComparisonFactor %in% c("CGM22_GO_e8","CGM23_GO_e8") )
ggplotLayer(legendPosition = "none",
iTitle="Hip Rotation") +
geom_consistencyLine(datatoPlot)
datatoPlot = filter(kinematicTableOMD,
Label == "KneeAngles" & Axis == "Z" & EventContext =="Involved" & Id=="03711" & Cycle==1 &
ComparisonFactor %in% c("CGM22_GO_e8","CGM23_GO_e8") )
datatoPlot
data_H4_IL%>%
ungroup()%>%
filter(Metrics >20)%>%
select(Id,Label,Axis,Cycle,Metrics,Comparisonlabel)%>%
distinct()
filter(kinematicTableOMD,
Label == "KneeAngles" & Axis == "Z" & EventContext =="Involved" & Id=="03711" & Cycle==1 &
ComparisonFactor %in% c("CGM22_GO_e8","CGM23_GO_e8") )
filter(kinematicTableOMD,
Label == "KneeAngles" & Axis == "Z" & EventContext =="Involved" & Id=="03711")
kinematicTableOMD$EventContext
filter(kinematicTableOMD,
Label == "KneeAngles" & Axis == "Z" & EventContext =="Involved")
datatoPlot = filter(kinematicTableOMD,
Label == "KneeAngles" & Axis == "Z"  & Id=="03711")
filter(kinematicTableOMD,
Label == "KneeAngles" & Axis == "Z"  & Id=="03711")
filter(kinematicTableOMD,
Label == "KneeAngles" & Axis == "Z"  & Id=="03711" & EventContext=="Involved")
filter(kinematicTableOMD,
Label == "KneeAngles" & Axis == "Z"  & Id=="03711")
popDesc_hug_cp
popDesc_hug = read_excel("C:/Users/fleboeuf/Documents/DATA/HUG/Population_description.xlsx")
popDesc_hug_cp = popDesc_hug%>%
select(Patient_ID,Age,	Gender,	Group,	GMFCS,	Affected_side,Height_mm,	Weight_kg,	BMI)%>%
distinct(Patient_ID, .keep_all = TRUE)%>%
filter(Group %in% c("CP","OMD"))%>%
rename(Ipp = Patient_ID)%>%
mutate(Ipp = paste0("0",as.character(Ipp)))
popDesc_hug_cp%>%
pivot_longer(cols= c("Height_mm","Weight_kg","Age","BMI"),
names_to = "anthropoParameters",
values_to = "Values")%>%
group_by(anthropoParameters)%>%
summarise(avg = mean(Values,na.rm = TRUE),
std = sd(Values, na.rm = TRUE))
tableOMD <- construct_HUD_omdData()
tableOMD2=left_join(tableOMD$Kinematic,popDesc_hug_cp, by = c("Ipp"))
kinematicTableOMD =  tableOMD2 %>%
mutate(
EventContext = case_when(
Affected_side == "Both" ~ "Involved",
EventContext == Affected_side ~ "Involved",
TRUE ~ "Uninvolved"  ))%>%
rename (Id = Ipp)%>%
defineComparisonfactor(c("CGM","Pose"))%>%
filter(Label %ni% c("LForeFootAngles","RForeFootAngles"))%>%
mutate(Label = substring(Label,2),
Population = "OMD")%>%
group_by(Id,ComparisonFactor,Label,Axis,EventContext)%>%
mutate(Cycle = 1:n())
descKinematicTableOMD <- DescritiveFrameSequence(kinematicTableOMD,bySubjectFlag = FALSE)
data1 = computeMetrics(kinematicTableOMD, "CGM22_GO_e8","CGM23_GO_e8",comparisonLabel = "22KF8_vs_23KF8",metric="mae")
data2 = computeMetrics(kinematicTableOMD, "CGM22_GO_kalman","CGM23_GO_kalman",comparisonLabel = "22KKF_vs_23KKF",metric="mae")
data_H4_IL = bind_rows(data1,data2)
desc_H4_IL = data_H4_IL%>%
filter(Label %in% c("PelvisAngles","HipAngles","KneeAngles", "AnkleAngles","FootProgressAngles"))%>%
group_by(Id,Label,Axis,Comparisonlabel)%>%
summarise(avg =  mean(Metrics),
std = sd(Metrics))%>%
filter(!(Axis %in% c("X", "Y") & Label == "FootProgressAngles"))
desc_H4_IL
ggplot(desc_H4_IL, aes(x=Label, y= avg, color = Axis))+geom_boxplot()+facet_grid(Comparisonlabel~.)
data1 = computeMetrics(kinematicTableOMD, "CGM22_GO_e8","CGM23_GO_e8",comparisonLabel = "22KF8_vs_23KF8",metric="mae")
data2 = computeMetrics(kinematicTableOMD, "CGM22_GO_kalman","CGM23_GO_kalman",comparisonLabel = "22KKF_vs_23KKF",metric="mae")
data_H4_IL = bind_rows(data1,data2)
desc_H4_IL = data_H4_IL%>%
filter(Label %in% c("PelvisAngles","HipAngles","KneeAngles", "AnkleAngles","FootProgressAngles"),
EventContext =="Involved")%>%
group_by(Id,Label,Axis,Comparisonlabel)%>%
summarise(avg =  mean(Metrics),
std = sd(Metrics))%>%
filter(!(Axis %in% c("X", "Y") & Label == "FootProgressAngles"))
desc_H4_IL
ggplot(desc_H4_IL, aes(x=Label, y= avg, color = Axis))+geom_boxplot()+facet_grid(Comparisonlabel~.)
# data_H4_IL%>%
#   ungroup()%>%
#   filter(Metrics >20)%>%
#   select(Id,Label,Axis,Cycle,Metrics,Comparisonlabel)%>%
#   distinct()
#
#
#
# datatoPlot = filter(kinematicTableOMD,
#                     Label == "KneeAngles" & Axis == "Z"  & Id=="03711") & EventContext=="Involved") & Cycle==1 &
#                       ComparisonFactor %in% c("CGM22_GO_e8","CGM23_GO_e8") )
# kinematicTableOMD$EventContext
#
# ggplotLayer(legendPosition = "none",
#                       iTitle="Hip Rotation") +
#     geom_consistencyLine(datatoPlot)
data1 = computeMetrics(kinematicTableOMD, "CGM22_GO_e8","CGM22_GO_kalman",comparisonLabel = "22KF8_vs_22KKF",metric="mae")
data2 = computeMetrics(kinematicTableOMD, "CGM23_GO_e8","CGM23_GO_kalman",comparisonLabel = "23KF8_vs_23KKF",metric="mae")
data_H5_IL = bind_rows(data1,data2)
desc_H5_IL = data_H5_IL%>%
filter(Label %in% c("PelvisAngles","HipAngles","KneeAngles", "AnkleAngles","FootProgressAngles") &
EventContext =="Involved")%>%
group_by(Id,Label,Axis,Comparisonlabel)%>%
summarise(avg =  mean(Metrics),
std = sd(Metrics))%>%
filter(!(Axis %in% c("X", "Y") & Label == "FootProgressAngles"))
desc_H5_IL
ggplot(desc_H5_IL, aes(x=Label, y= avg, color = Axis))+geom_boxplot()+facet_grid(Comparisonlabel~.)
desc_H5_IL = data_H5_IL%>%
filter(Label %in% c("PelvisAngles","HipAngles","KneeAngles", "AnkleAngles","FootProgressAngles") &
EventContext =="Uninvolved")%>%
group_by(Id,Label,Axis,Comparisonlabel)%>%
summarise(avg =  mean(Metrics),
std = sd(Metrics))%>%
filter(!(Axis %in% c("X", "Y") & Label == "FootProgressAngles"))
desc_H5_IL
ggplot(desc_H5_IL, aes(x=Label, y= avg, color = Axis))+geom_boxplot()+facet_grid(Comparisonlabel~.)
desc_H4_IL = data_H4_IL%>%
filter(Label %in% c("PelvisAngles","HipAngles","KneeAngles", "AnkleAngles","FootProgressAngles"),
EventContext =="Uninvolved")%>%
group_by(Id,Label,Axis,Comparisonlabel)%>%
summarise(avg =  mean(Metrics),
std = sd(Metrics))%>%
filter(!(Axis %in% c("X", "Y") & Label == "FootProgressAngles"))
desc_H4_IL
ggplot(desc_H4_IL, aes(x=Label, y= avg, color = Axis))+geom_boxplot()+facet_grid(Comparisonlabel~.)
data_H4_IL%>%
ungroup()%>%
filter(Metrics >20)%>%
select(Id,Label,Axis,Cycle,Metrics,Comparisonlabel,EventContext)%>%
distinct()
datatoPlot = filter(kinematicTableOMD,
Label == "KneeAngles" & Axis == "Z"  & Id=="03711" & EventContext=="Uninvolved" &
Cycle==1 &  ComparisonFactor %in% c("CGM22_GO_e8","CGM23_GO_e8") )
ggplotLayer(legendPosition = "none",
iTitle="Hip Rotation") +
geom_consistencyLine(datatoPlot)
datatoPlot = filter(kinematicTableOMD,
Label == "KneeAngles" & Axis == "Z"  & Id=="03711" & EventContext=="Uninvolved" &
ComparisonFactor %in% c("CGM22_GO_e8","CGM23_GO_e8") )
# #
ggplotLayer(legendPosition = "none",
iTitle="Hip Rotation") +
geom_consistencyLine(datatoPlot)
datatoPlot = filter(kinematicTableOMD,
Label == "KneeAngles" & Axis == "Z"  & Id=="03711" & EventContext=="Uninvolved" &
ComparisonFactor %in% c("CGM22_GO_e8") )
# #
ggplotLayer(legendPosition = "none",
iTitle="Hip Rotation") +
geom_consistencyLine(datatoPlot)
datatoPlot = filter(kinematicTableOMD,
Label == "KneeAngles" & Axis == "Z"  & Id=="03711" & EventContext=="Uninvolved" &
ComparisonFactor %in% c("CGM23_GO_e8") )
# #
ggplotLayer(legendPosition = "none",
iTitle="Hip Rotation") +
geom_consistencyLine(datatoPlot)
data_H4_IL%>%
ungroup()%>%
filter(Metrics >20)%>%
select(Id,Label,Axis,Cycle,Metrics,Comparisonlabel,EventContext)%>%
distinct()
data_H4_IL%>%
ungroup()%>%
filter(Metrics >20)%>%
select(Id,Label,Axis,Cycle,Metrics,Comparisonlabel,EventContext)%>%
distinct(Id)
